
# ğŸ§­ Week 1 â€“ Xenium Data Overview and Loading

**Learning Goals**
- Understand Xenium output files
- Load raw Xenium data into R using `LoadXenium()`
- Explore metadata and perform basic QC

## Xenium Output Files at a Glance

The **Xenium Onboard Analysis (XOA)** pipeline generates a rich set of decoded transcript data and morphology images for each selected region.  
These outputs provide the foundation for spatial analysis in R and visualization in **Xenium Explorer**.

---

## ğŸ§¬ Overview

Raw Xenium output bundles contain:
- **Decoded transcript coordinates and counts**
- **Morphology images** (DAPI / cell-segmentation channels)
- **Cell and nucleus segmentation polygons**
- **Derived matrices and QC summaries**

Low-level image sensor data are compressed into these standardized files so that essential spatial and quality information is preserved.

---

## ğŸ“ Output Bundle Structure

Each Xenium experiment directory contains one folder per region of interest (ROI).  
Inside each ROI folder youâ€™ll find the following groups of files:

| **Category** | **File(s)** | **Description** | **Readable in Xenium Explorer?** |
|---------------|-------------|-----------------|----------------------------------|
| **Experiment manifest** | `experiment.xenium` | Defines experiment metadata and links all outputs. | âœ… Required |
| **Interactive summary** | `analysis_summary.html` | HTML dashboard with key QC metrics, plots, and images. | â€” |
| **Morphology images** | `morphology.ome.tif` | 3-D DAPI image stack in OME-TIFF format. | âœ… |
|  | `morphology_focus/` | Multi-focus projections (2-D) for each stain; includes DAPI + additional segmentation channels. | âœ… (for multimodal assay) |
| **Cell summary** | `cells.csv.gz`, `cells.parquet` | Per-cell metrics: transcript counts, area, morphology stats. | âœ… |
| **Cell segmentation masks** | `cells.zarr.zip` | Zarr archive containing nucleus + cell masks used for transcript assignment. | âœ… |
| **Cell boundaries** | `cell_boundaries.csv.gz`, `cell_boundaries.parquet` | Polygon coordinates outlining each cell. | âœ… |
| **Nucleus boundaries** | `nucleus_boundaries.csv.gz`, `nucleus_boundaries.parquet` | Polygon coordinates outlining each nucleus. | âœ… |
| **Transcript data** | `transcripts.parquet`, `transcripts.zarr.zip` | Coordinates and gene identity for every detected transcript. | âœ… |
| **Cell-feature matrix** | `cell_feature_matrix/`, `cell_feature_matrix.h5`, `cell_feature_matrix.zarr.zip` | Sparse matrix of gene Ã— cell counts in multiple formats (MTX / HDF5 / Zarr). | âœ… |
| **Metric summary** | `metrics_summary.csv` | Global summary of sequencing and decoding metrics. | â€” |
| **Secondary analysis** | `analysis/`, `analysis.zarr.zip` | Processed data and derived results (e.g., clustering). | â€” |
| **Panels** | `gene_panel.json`, `protein_panel.json` | Gene and (if applicable) protein panel definitions. | â€” |

---

## ğŸ§© Auxiliary Output Files (`aux_outputs/`)

Additional QC and image files supporting troubleshooting and alignment.

| **File / Folder** | **Description** | **Readable in Xenium Explorer?** |
|--------------------|-----------------|----------------------------------|
| `morphology_fov_locations.json` | Field-of-view positions in microns. | â€” |
| `overview_scan_fov_locations.json` | Field-of-view positions in pixels. | â€” |
| `per_cycle_channel_images/` | Down-sampled RNA images (TIFF) for each cycle Ã— channel. | â€” |
| `overview_scan.png` | Whole-slide overview image. | â€” |
| `background_qc_images/` | Autofluorescence background images used for correction. | â€” |
| `morphology_focus_qc_masks/` | 8-bit saturation QC masks; 255 = saturated pixel, 0 = not. | âœ… (importable) |

---

## ğŸ§  Practical Tips

- **Start with `analysis_summary.html`** to QC decoding and cell segmentation before diving into R.  
- **Use `LoadXenium()`** in Seurat v5 to automatically import `cells.csv.gz`, `transcripts.parquet`, and related metadata.  
- The **`cells.zarr.zip`** file contains segmentation masks â€” you generally wonâ€™t open it manually but itâ€™s crucial for spatial assignments.  
- Keep the **folder hierarchy intact** when moving data; Xenium Explorer expects relative paths as generated by the pipeline.  
- Archive large morphology images (`.ome.tif`) on shared storage; they can be > 10 GB per ROI.

---

## ğŸ§° Load Data in R
```r
library(Seurat)
xen <- LoadXenium(path = "data/demo_xenium/")  # update this path to your dataset
xen
head(xen@meta.data)
```

## ğŸ§ª Practice
1. Count cells/genes in the dataset.  
2. Plot total transcripts per cell with `VlnPlot(xen, "nCount_Spatial")`.  
3. Summarize file roles in a short paragraph.
